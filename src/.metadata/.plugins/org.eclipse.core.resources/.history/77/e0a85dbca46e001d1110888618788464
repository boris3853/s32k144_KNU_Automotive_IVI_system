#include "device_registers.h"

void port_init()
{
    // GPIO PCC 설정 - CGC 마스킹
    PCC->PCCn[PCC_PORTA_INDEX] = PCC_PCCn_CGC_MASK;
    PCC->PCCn[PCC_PORTB_INDEX] = PCC_PCCn_CGC_MASK;

    // PORTA: PA4 PA6 PA7 PA8 PA9 PA10 PA11 MUX 설정
    PORTA->PCR[4] = PORT_PCR_MUX(1);
    PORTA->PCR[6] = PORT_PCR_MUX(1);
    PORTA->PCR[7] = PORT_PCR_MUX(1);
    PORTA->PCR[8] = PORT_PCR_MUX(1);
    PORTB->PCR[9] = PORT_PCR_MUX(1);
    PORTB->PCR[10] = PORT_PCR_MUX(1);
    PORTB->PCR[11] = PORT_PCR_MUX(1);

    /* GPIOA PDDR 설정
    // INPUT: PA4 PA6 PA7 PA8
    // OUTPUT: PA9 PA10 PA11
    */
    PTA->PDDR &= ~((1<<4)|(1<<6)|(1<<7)|(1<<8));
    PTB->PDDR |= (1<<9)|(1<<10)|(1<<11);
}

void TEST()
{
    if(PTA->PDIR & (1<<4))
        PTB->PCOR |= (1<<9);
    else
        PTB->PSOR |= (1<<9);

    if(PTA->PDIR & (1<<5))
        PTB->PCOR |= (1<<10);
    else
        PTB->PSOR |= (1<<10);

    if(PTA->PDIR & (1<<6))
        PTB->PCOR |= (1<<11);
    else
        PTB->PSOR |= (1<<11);
}

// test
int main(void){
    port_init();

    while(1)
    {
        TEST();
    }
}
