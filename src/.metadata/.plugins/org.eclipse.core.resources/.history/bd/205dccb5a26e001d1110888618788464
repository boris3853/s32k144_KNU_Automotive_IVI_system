#define PCC_PORTA *((volatile unsigned*)(PCC_BASE+0x124))

#define GPIOA_PDDR *((volatile unsigned*)(PTA_BASE+0x14))

#define GPIOA_PSOR *((volatile unsigned*)(PTA_BASE+0x04))
#define GPIOA_PCOR *((volatile unsigned*)(PTA_BASE+0x08))
#define GPIOA_PDIR *((volatile unsigned*)(PTA_BASE+0x10))

// SWITCH
#define PORTA_PCR4 *((volatile unsigned*)(PORTA_BASE+0x10))
#define PORTA_PCR6 *((volatile unsigned*)(PORTA_BASE+0x18))
#define PORTA_PCR7 *((volatile unsigned*)(PORTA_BASE+0x1C))
#define PORTA_PCR8 *((volatile unsigned*)(PORTA_BASE+0x20))

// LED
#define PORTA_PCR9 *((volatile unsigned*)(PORTA_BASE+0x24))
#define PORTA_PCR10 *((volatile unsigned*)(PORTA_BASE+0x28))
#define PORTA_PCR11 *((volatile unsigned*)(PORTA_BASE+0x2C))


#include "S32K144.h"

void GPIO_PORT_INIT()
{
    // GPIO PCC 설정 - CGC 마스킹
    PCC_PORTA |= PCC_PCCn_CGC_MASK;

    // PORTA: PA4 PA6 PA7 PA8 PA9 PA10 PA11 MUX 설정
    PORTA_PCR4 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR4 |= (1<<PORT_PCR_MUX_SHIFT);

    PORTA_PCR6 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR6 |= (1<<PORT_PCR_MUX_SHIFT);

    PORTA_PCR7 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR7 |= (1<<PORT_PCR_MUX_SHIFT);

    PORTA_PCR8 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR8 |= (1<<PORT_PCR_MUX_SHIFT);

    PORTA_PCR9 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR9 |= (1<<PORT_PCR_MUX_SHIFT);

    PORTA_PCR10 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR10 |= (1<<PORT_PCR_MUX_SHIFT);

    PORTA_PCR11 &= ~((0b111)<<PORT_PCR_MUX_SHIFT);
    PORTA_PCR11 |= (1<<PORT_PCR_MUX_SHIFT);

    /* GPIOA PDDR 설정
    // INPUT: PA4 PA6 PA7 PA8
    // OUTPUT: PA9 PA10 PA11
    */
    GPIOA_PDDR &= ~((1<<4) | (1<<6) |(1<<7) |(1<<8));
    GPIOA_PDDR |= (1<<9) | (1<<10) | (1<<11);
}

void TEST()
{
    if(GPIOA_PDIR & (1<<4))
            GPIOA_PCOR |= (1<<9);
        else
            GPIOA_PSOR |= (1<<9);

    if(GPIOA_PDIR & (1<<5))
        GPIOA_PCOR |= (1<<10);
    else
        GPIOA_PSOR |= (1<<10);

    if(GPIOA_PDIR & (1<<6))
        GPIOA_PCOR |= (1<<11);
    else
        GPIOA_PSOR |= (1<<11);
}

// test
int main(void){
    GPIO_PORT_INIT();

    while(1)
    {
        TEST();
    }
}
